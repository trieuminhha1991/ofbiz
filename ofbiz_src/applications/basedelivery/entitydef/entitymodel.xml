<?xml version="1.0" encoding="UTF-8"?>
<entitymodel xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
             xsi:noNamespaceSchemaLocation="http://ofbiz.apache.org/dtds/entitymodel.xsd">
    <!-- ========================================================= -->
    <!-- ======================== Defaults ======================= -->
    <!-- ========================================================= -->
    <title>Entity of basedelivery Component</title>
    <description>None</description>
    <copyright></copyright>
    <version></version>

    <entity entity-name="VehicleV2" package-name="com.olbius.basedelivery">
        <description>Vehicle V2</description>
        <field name="vehicleId" type="id-ne"></field>
        <field name="name" type="name"></field>
        <field name="loading" type="name"></field> <!-- Tải trọng -->
        <field name="licensePlate" type="name"></field> <!--Biển số xe-->
        <field name="volume" type="name"></field> <!--Thể tích-->
        <field name="reqNo" type="name"></field> <!--Đăng ký xe-->
        <field name="height" type="name"></field> <!--Chiều cao-->
        <field name="width" type="name"></field> <!--Chiều rộng-->
        <field name="longitude" type="name"></field> <!--Chiều dài-->
        <field name="vehicleTypeId" type="name"></field> <!--Loại xe-->
        <field name="description" type="description"></field>
        <field name="fromDate" type="date-time"></field>
        <field name="thruDate" type="date-time"></field>
        <prim-key field="vehicleId"/>
    </entity>

    <entity entity-name="VehicleType" package-name="com.olbius.basedelivery">
        <description>Vehicle Type</description>
        <field name="vehicleTypeId" type="id-ne"></field>
        <field name="code" type="name"></field> <!-- Tải trọng -->
        <field name="name" type="name"></field> <!-- Tải trọng -->
        <prim-key field="vehicleTypeId"/>
    </entity>

    <entity entity-name="SupplierVehicle" package-name="com.olbius.basedelivery">
        <description>Bảng quan hệ giữa nhà cung cấp và xe</description>
        <field name="supplierVehicleId" type="id-ne"></field>
        <field name="partyId" type="name"></field>
        <field name="vehicleId" type="name"></field>
        <field name="fromDate" type="date-time"></field>
        <field name="thruDate" type="date-time"></field>
        <field name="statusId" type="name"></field>
        <prim-key field="supplierVehicleId"></prim-key>
    </entity>

    <entity entity-name="Trip" package-name="com.olbius.basedelivery.trip">
        <field name="tripId" type="id-ne"></field>
        <field name="tripNo" type="name"></field>
        <field name="scLogId" type="name"></field> <!--Công ty đăng ký sử dụng dịch vụ-->
        <field name="contractorId" type="name"></field> <!--Nhà cung cấp dịch vụ vận tải-->
        <field name="vehicleName" type="name"></field> <!--Chọn xe, tài xế-->
        <field name="vehicleId" type="name"></field> <!--Xe vận chuyển-->
        <field name="driverId" type="name"></field> <!--Người vận chuyển-->
        <field name="tripAmount" type="currency-amount"></field> <!--Thời điểm vận chuyển-->
        <field name="statusId" type="name"></field> <!-- Trạng Thái -->
        <field name="createdByUserLogin" type="name"></field> <!-- Trạng Thái -->
        <field name="description" type="description"></field>
        <field name="tripStartDate" type="date-time"></field>
        <field name="createdDate" type="date-time"></field>
        <field name="currentSeal" type="name"></field> <!--So seal hien tai -->
        <field name="totalWeight"
               type="currency-amount"></field> <!-- Tong khoi luong hang hoa trong chuyen van chuyen -->
        <prim-key field="tripId"/>
    </entity>

    <entity entity-name="DeliverySchedule" package-name="com.olbius.basedelivery">
        <description> thiết lập thông tin lịch vận chuyển</description>
        <field name="deliveryScheduleId" type="id-ne"></field>
        <field name="dayOfWeekId" type="name"></field>
        <field name="dayOfMonthId" type="name"></field>
        <prim-key field="deliveryScheduleId"></prim-key>
    </entity>

    <entity entity-name="TripDetail" package-name="com.olbius.basedelivery.trip">
        <field name="tripDetailId" type="id-ne"></field>
        <field name="tripId" type="name"></field>
        <field name="deliveryId" type="name"></field> <!--địa chỉ hàng được chuyển tới-->
        <prim-key field="tripDetailId"/>
    </entity>

    <!--View Entity-->

    <view-entity entity-name="TripItemDetail" package-name="com.olbius.basedelivery.trip">
        <member-entity entity-alias="ORDITEM" entity-name="OrderItem"/>
        <member-entity entity-alias="DIM" entity-name="DeliveryItem"/>
        <member-entity entity-alias="TRD" entity-name="TripDetail"/>
        <member-entity entity-alias="PROD" entity-name="Product"/>
        <!--<alias-all entity-alias="ORDCOM"></alias-all>-->
        <alias name="exportedQuantity" function="sum" entity-alias="DIM">
            <complex-alias operator="-">
                <complex-alias-field field="actualExportedQuantity" entity-alias="DIM"
                                     default-value="0"/>
                <!--<complex-alias-field field="cancelQuantity" entity-alias="ORDITEM" default-value="0"/>-->
            </complex-alias>
        </alias>
        <alias name="productId" entity-alias="ORDITEM" group-by="true"></alias>
        <alias name="tripId" entity-alias="TRD" group-by="true"></alias>
        <alias name="productName" entity-alias="PROD" group-by="true"></alias>
        <view-link entity-alias="DIM" rel-entity-alias="ORDITEM">
            <key-map field-name="fromOrderId" rel-field-name="orderId"/>
            <key-map field-name="fromOrderItemSeqId" rel-field-name="orderItemSeqId"/>
        </view-link>
        <view-link entity-alias="ORDITEM" rel-entity-alias="PROD">
            <key-map field-name="productId" rel-field-name="productId"/>
        </view-link>
        <view-link entity-alias="DIM" rel-entity-alias="TRD">
            <key-map field-name="deliveryId"/>
        </view-link>
    </view-entity>

    <view-entity entity-name="DeliveryProductStoreGroup" package-name="com.olbius.basedelivery">
        <member-entity entity-name="Delivery" entity-alias="DL"/>
        <member-entity entity-name="OrderRole" entity-alias="ORR"/>
        <member-entity entity-name="ProductStore" entity-alias="PS"/>
        <alias-all entity-alias="DL"></alias-all>
        <alias name="primaryStoreGroupId" entity-alias="PS"></alias>
        <view-link entity-alias="DL" rel-entity-alias="ORR">
            <key-map field-name="orderId"/>
            <entity-condition>
                <condition-expr field-name="roleTypeId" operator="equals"
                                value="BILL_TO_CUSTOMER" entity-alias="ORR"/>
            </entity-condition>
        </view-link>
        <view-link entity-alias="ORR" rel-entity-alias="PS" rel-optional="true">
            <key-map field-name="partyId" rel-field-name="payToPartyId"></key-map>
        </view-link>
    </view-entity>

</entitymodel>
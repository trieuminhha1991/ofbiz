<#macro jqGridMinimumLib>
    <script type="text/javascript" src="/aceadmin/jqw/jqwidgets/jqxdata.js"></script>
    <script type="text/javascript" src="/aceadmin/jqw/jqwidgets/jqxdata.extend.js"></script>
    <script type="text/javascript" src="/aceadmin/jqw/jqwidgets/jqxbuttons.js"></script>
    <script type="text/javascript" src="/aceadmin/jqw/jqwidgets/jqxscrollbar.js"></script>
    <script type="text/javascript" src="/aceadmin/jqw/jqwidgets/jqxlistbox.js"></script>
    <script type="text/javascript" src="/aceadmin/jqw/jqwidgets/jqxlistbox.extend.js"></script>
    <script type="text/javascript" src="/aceadmin/jqw/jqwidgets/jqxdropdownlist.js"></script>
    <script type="text/javascript" src="/aceadmin/jqw/jqwidgets/jqxpanel.js"></script>
    <script type="text/javascript" src="/aceadmin/jqw/jqwidgets/jqxcalendar.js"></script>
    <script type="text/javascript" src="/aceadmin/jqw/jqwidgets/jqxdatetimeinput.js"></script>
    <script type="text/javascript" src="/aceadmin/jqw/jqwidgets/jqxdata.export.js"></script>
    <script type="text/javascript" src="/aceadmin/jqw/jqwidgets/jqxcheckbox.js"></script>
    <script type="text/javascript" src="/aceadmin/jqw/jqwidgets/jqxradiobutton.js"></script>
    <script type="text/javascript" src="/aceadmin/jqw/jqwidgets/jqxnotification2.js"></script>
    <script type="text/javascript" src="/aceadmin/jqw/jqwidgets/jqxdropdownbutton.js"></script>
    <script type="text/javascript" src="/aceadmin/jqw/jqwidgets/jqxtooltip.js"></script>
    <script type="text/javascript" src="/aceadmin/jqw/jqwidgets/globalization/globalize.js"></script>
    <script type="text/javascript" src="/aceadmin/jqw/jqwidgets/jqxwindow.js"></script>
    <script type="text/javascript" src="/aceadmin/jqw/jqwidgets/jqxvalidator.js"></script>
    <script type="text/javascript" src="/aceadmin/jqw/jqwidgets/jqxnumberinput.js"></script>
    <script type="text/javascript" src="/aceadmin/jqw/jqwidgets/jqxnumberinput.extend.js"></script>
    <script type="text/javascript" src="/aceadmin/jqw/jqwidgets/jqxinput.js"></script>
    <script type="text/javascript" src="/aceadmin/jqw/jqwidgets/jqxtabs.js"></script>
    <script type="text/javascript" src="/aceadmin/jqw/jqwidgets/jqxgrid.js"></script>
    <script type="text/javascript" src="/aceadmin/jqw/jqwidgets/jqxgrid.extend.js?v=0.001"></script>
    <script type="text/javascript" src="/aceadmin/jqw/jqwidgets/jqxgrid.filter.js"></script>
    <script type="text/javascript" src="/aceadmin/jqw/jqwidgets/jqxgrid.filter.extend.js"></script>
    <script type="text/javascript" src="/aceadmin/jqw/jqwidgets/jqxgrid.sort.js"></script>
    <script type="text/javascript" src="/aceadmin/jqw/jqwidgets/jqxgrid.sort.extend.js"></script>
    <script type="text/javascript" src="/aceadmin/jqw/jqwidgets/jqxgrid.selection.js"></script>
    <script type="text/javascript" src="/aceadmin/jqw/jqwidgets/jqxgrid.selection.extend.js"></script>
    <script type="text/javascript" src="/aceadmin/jqw/jqwidgets/jqxgrid.export.js"></script>
    <script type="text/javascript" src="/aceadmin/jqw/jqwidgets/jqxgrid.aggregates.js"></script>
    <script type="text/javascript" src="/aceadmin/jqw/jqwidgets/jqxgrid.columnsreorder.js"></script>
    <script type="text/javascript" src="/aceadmin/jqw/jqwidgets/jqxgrid.columnsresize.js"></script>
    <script type="text/javascript" src="/aceadmin/jqw/jqwidgets/jqxgrid.grouping.js"></script>
    <script type="text/javascript" src="/aceadmin/jqw/jqwidgets/jqxgrid.pager.js"></script> 
    <script type="text/javascript" src="/aceadmin/jqw/jqwidgets/jqxgrid.pager.extend.js"></script> 
    <script type="text/javascript" src="/aceadmin/jqw/jqwidgets/jqxgrid.edit.js"></script>
    <script type="text/javascript" src="/aceadmin/jqw/jqwidgets/jqxgrid.edit.extend.js"></script>
    <script type="text/javascript" src="/aceadmin/jqw/jqwidgets/jqxmenu.js"></script>
    <script type="text/javascript" src="/aceadmin/assets/js/bootbox.min.js"></script>
    <script type="text/javascript" src="/aceadmin/jqw/jqwidgets/jqx.utils.js?v=0.0.4"></script>
    <#-- <script type="text/javascript" src="/aceadmin/jqw/jqwidgets/ett/olb.core.js"></script> imported in header.ftl -->
	<script type="text/javascript" src="/aceadmin/jqw/jqwidgets/ett/olb.util.js?v=0.0.1"></script>
    <#include "jqwLocalization.ftl"/>
    <#include 'jqwLibraryUiLabel.ftl'/>
</#macro>
<#macro jqTreeGridMinimumLib>
    <script type="text/javascript" src="/aceadmin/jqw/jqwidgets/jqxcore.js"></script>
	<script type="text/javascript" src="/aceadmin/jqw/jqwidgets/jqxdata.js"></script>
	<script type="text/javascript" src="/aceadmin/jqw/jqwidgets/jqxbuttons.js"></script>
	<script type="text/javascript" src="/aceadmin/jqw/jqwidgets/jqxscrollbar.js"></script>
	<script type="text/javascript" src="/aceadmin/jqw/jqwidgets/jqxdatatable.js"></script>
	<script type="text/javascript" src="/aceadmin/jqw/jqwidgets/jqxtreegrid.js"></script>
	<script type="text/javascript" src="/aceadmin/jqw/jqwidgets/jqxlistbox.js"></script>
	<script type="text/javascript" src="/aceadmin/jqw/jqwidgets/jqxdropdownlist.js"></script>
	<script type="text/javascript" src="/aceadmin/jqw/jqwidgets/jqxcheckbox.js"></script>
	<script type="text/javascript" src="/aceadmin/jqw/jqwidgets/jqxcolorpicker.js"></script>
	<script type="text/javascript" src="/aceadmin/jqw/jqwidgets/jqxinput.js"></script>
	<script type="text/javascript" src="/aceadmin/jqw/jqwidgets/jqxdropdownbutton.js"></script>
	<script type="text/javascript" src="/aceadmin/jqw/jqwidgets/jqxnotification2.js"></script>
	<script type="text/javascript" src="/aceadmin/jqw/jqwidgets/jqxcombobox.js"></script>
	<script type="text/javascript" src="/aceadmin/jqw/jqwidgets/jqxmenu.js"></script>
    <script type="text/javascript" src="/aceadmin/assets/js/bootbox.min.js"></script>
    <script type="text/javascript" src="/aceadmin/jqw/jqwidgets/jqx.utils.js?v=0.0.4"></script>
    <#-- <script type="text/javascript" src="/aceadmin/jqw/jqwidgets/ett/olb.core.js"></script> imported in header.ftl -->
	<script type="text/javascript" src="/aceadmin/jqw/jqwidgets/ett/olb.util.js?v=0.0.1"></script>
    <#include "jqwLocalization.ftl"/>
    <#include 'jqwLibraryUiLabel.ftl'/>
</#macro>

<#-- 
@jqOlbCoreLib
Description: import scripts 'olb'
Parameter: hasCore, boolean, optional, default 'true' - import script olb core, util.
Parameter: onlyCore, boolean, optional, default 'false' - has import script olb util. If it is 'true' then not import olb util.
Parameter: hasGrid, boolean, optional, default 'false' - import script olb grid.
Parameter: hasTreeGrid, boolean, optional, default 'false' - import script olb tree grid.
Parameter: hasComboBox, boolean, optional, default 'false' - import script olb combobox.
Parameter: hasComboBoxSearchRemote, boolean, optional, default 'false' - import script olb combobox advance search remote F1.
Parameter: hasDropDownButton, boolean, optional, default 'false' - import script olb dropdownbutton.
Parameter: hasDropDownList, boolean, optional, default 'false' - import script olb dropdownlist.
Parameter: hasValidator, boolean, optional, default 'false' - import script olb validator. And library jqx validator.
-->
<#macro jqOlbCoreLib hasCore=true onlyCore=false hasGrid=false hasTreeGrid=false hasComboBox=false hasComboBoxSearchRemote=false 
			hasDropDownButton=false hasDropDownList=false hasValidator=false>
	<#if hasCore>
		<script type="text/javascript" src="/aceadmin/jqw/jqwidgets/ett/olb.core.js?v=0.0.1"></script>
		<#if !onlyCore><script type="text/javascript" src="/aceadmin/jqw/jqwidgets/ett/olb.util.js?v=0.0.1"></script></#if>
	</#if>
	<#if hasGrid><script type="text/javascript" src="/aceadmin/jqw/jqwidgets/ett/olb.grid.js?v=0.0.5"></script></#if>
	<#if hasTreeGrid><script type="text/javascript" src="/aceadmin/jqw/jqwidgets/ett/olb.treegrid.js?v=0.0.2"></script></#if>
	<#if hasComboBox><script type="text/javascript" src="/aceadmin/jqw/jqwidgets/ett/olb.combobox.js?v=0.0.1"></script></#if>
	<#if hasDropDownButton><script type="text/javascript" src="/aceadmin/jqw/jqwidgets/ett/olb.dropdownbutton.js?v=0.0.3"></script></#if>
	<#if hasDropDownList><script type="text/javascript" src="/aceadmin/jqw/jqwidgets/ett/olb.dropdownlist.js?v=0.0.3"></script></#if>
	<#if hasValidator>
		<script type="text/javascript" src="/aceadmin/jqw/jqwidgets/jqxvalidator.js?v=0.0.1"></script>
		<script type="text/javascript" src="/aceadmin/jqw/jqwidgets/ett/olb.validator.js?v=0.0.2"></script>
	</#if>
	<#if hasComboBoxSearchRemote><script type="text/javascript" src="/aceadmin/jqw/jqwidgets/ett/olb.combobox.search.remote.js?v=0.0.1"></script></#if>
</#macro>
<#global jqOlbCoreLib=jqOlbCoreLib>

<#macro useLocalizationNumberFunction>
<script type="text/javascript">
    var convertLocalNumber = function(num){
        if(num == null){
            return "";
        }
        decimalseparator = ".";
        thousandsseparator = ",";
        if("${locale}" == "vi"){
            decimalseparator = ",";
            thousandsseparator = ".";
        }
        var str = num.toString(), parts = false, output = [], i = 1, formatted = null;
        if(str.indexOf(".") > 0) {
            parts = str.split(".");
            str = parts[0];
        }
        str = str.split("").reverse();
        for(var j = 0, len = str.length; j < len; j++) {
            if(str[j] != ",") {
                output.push(str[j]);
                if(i%3 == 0 && j < (len - 1)) {
                    output.push(thousandsseparator);
                }
                i++;
            }
        }
        formatted = output.reverse().join("");
        return(formatted + ((parts) ? decimalseparator + parts[1].substr(0, 6) : ""));
    };
</script>
</#macro>

<#macro jqGrid url columnlist dataField initrowdetailsDetail="" isShowTitleProperty="true" customTitleProperties="" columngrouplist="" updaterow="" addColumns="" deleterow="" addrow="" updateUrl="" createUrl="" 
               removeUrl="" showtoolbar="true" addmultiplerows="false" updateMulUrl="" updatemultiplerows="" updateoffline="false" offlinerefreshbutton="true" deleteConditionFunction="" refreshbutton="false"
               excelExport="false" toPrint="false" filterbutton="" clearfilteringbutton="false" noConditionFind="N" otherCondition="" conditionsFind="N" doubleClick="false" dictionaryColumns="" groupable="false"
               primaryColumn="ID" editable="false" editColumns="" id="jqxgrid" dataType="json" filterable="true" filtersimplemode="true" viewSize="15" viewIndex="0" width="100%" height="500" autorowheight="false"
               pageable="true" columnsresize="true" columnsreorder="true" sortable="true" defaultSortColumn="" autoheight="true" currencySymbol="d" selectionmode="singlerow" addrefresh="false" 
               showstatusbar="false" editpopup="false" initrowdetails="false" keyvalue="" deleteColumn="" addinitvalue="" addType="direct" entityName="" groups="" alternativeAddPopup=""
               editmode="selectedrow" jqGridMinimumLibEnable="true" otherParams="" sortdirection="asc" altrows="false" sourceId="Id" rowselectfunction="" bindingcompletefunction="" rowunselectfunction="" idExisted="false"
               ulistname="" updatelist="false"  editrefresh="false" groupsexpanded="false" pagesizeoptions="['5', '10', '15', '20', '25', '30', '50', '100']" contextMenuId="contextMenuId" mouseRightMenu="false"
               usecurrencyfunction="true" deletesuccessfunction="" autoload="true" statusbarheight="50" dropdownlist="false" ddlSource="" displayMember="" valueMember="" sendEmail="false" changeState="false" 
               bindresize="false" customcontrol1="" customcontrol2="" customcontrol3=""  customtoolbaraction=""  showlist="true" extraUrl="" offmode="false" allGridMenu="false" rowsheight="30" functionAfterUpdate="" functionAfterAddRow="" 
               customLoadFunction="false" rowdetailsheight="200" readyFunction="" rowdetailstemplateAdvance="" deletelocal="false" enablemousewheel="true" customCss="" functionAfterRowComplete=""
               exceptFieldToCompare="" confirmEditFunction="" scrollmode="deferred" updateRowFunction="" afterinitfunction="" deleteConditionMessage="" autoshowloadelement="true" showdefaultloadelement="true"
               beforeprocessing="" useCache="false" cacheMode="" keyCache="" keyEdit="" customControlAdvance="" autoMeasureHeight='false' isCollapse="false" timeout="" virtualmode="true" localdata="" datatype="" _customMessErr="" rightFloat="false"
               enabletooltips="false" columnsheight="30" isSaveFormData="false" formData="" displayTotal="false">
   <#if jqGridMinimumLibEnable=="true" || jqGridMinimumLibEnable=="">
    <@jqGridMinimumLib/>
   </#if>
    <script type="text/javascript">
        var wgdeletesuccess = "${StringUtil.wrapString(uiLabelMap.wgdeletesuccess)}";
        var wgupdatesuccess = "${StringUtil.wrapString(uiLabelMap.wgupdatesuccess)}";
        var wgaddsuccess = "${StringUtil.wrapString(uiLabelMap.wgaddsuccess)}";
    </script>
    <script type="text/javascript">
    	if (!dataGridCache) var dataGridCache = {};
    	dataGridCache["${id}IsInit"] = true;
    	dataGridCache["${id}TotalRows"] = 0;
    	
    	var getDataIsInit = function(gridId) {
    		var keyName = gridId + "IsInit";
			var isInit = dataGridCache[keyName];
			if (typeof isInit == 'undefined' || isInit == null) isInit = true;
			return isInit;
    	}
    	var setDataIsInit = function(gridId, isInit) {
    		var keyName = gridId + "IsInit";
    		dataGridCache[keyName] = !!isInit;
    	}
    	var getDataTotalRows = function(gridId) {
    		var keyName = gridId + "TotalRows";
    		return dataGridCache[keyName];
    	}
    	var setDataTotalRows = function(gridId, totalRows) {
    		var keyName = gridId + "TotalRows";
    		dataGridCache[keyName] = totalRows;
    	}

        /**add by dunglv**/
            <#if displayTotal == "true">
            var totalMap = {};
            </#if>
        /**end**/

        var tmpEditable = false;
        var editPending = false;
        $.jqx.theme = 'olbius';  
        theme = $.jqx.theme;     
        <#if customLoadFunction == "true">
            function initGrid${id}(){
                if($("#${id}").is('*[class^="jqx"]')){
                    return;
                }
        <#else>
            $(document).ready(function () {
        </#if>
            var grid = $("#${id}");
            clearData(grid);
            var source${id} =
            {
                id: '${sourceId}',
                <#if virtualmode == "false" && localdata != "">
            localdata : ${localdata},
                </#if>
                <#if virtualmode=="false" && datatype != "">
            datatype : "${datatype}",
                </#if>
                data: {
                    noConditionFind: '${noConditionFind}',
                    conditionsFind: '${conditionsFind}',
                    dictionaryColumns: '${dictionaryColumns}',
                    otherCondition: '${otherCondition}',
                    isInit: getDataIsInit("${id}"),
                },
                dataUrl: '${url}'<#if extraUrl != ""> + ${extraUrl}</#if>,
                beforeprocessing: function (data) {
                    var res = {};
                    var mTotalRows = data.TotalRows;
                    var mIsInit = getDataIsInit("${id}");
                    if (mIsInit) {
                    	res.totalrecords = mTotalRows;
                    	setDataTotalRows("${id}", mTotalRows);
                    } else {
                    	res.totalrecords = getDataTotalRows("${id}");
                    }
                    res.records = data.results;
                    // source${id}.totalrecords = data.TotalRows;
                    <#if beforeprocessing == "">
                    if(parseInt(data.TotalRows) <= 0){
                        grid.jqxGrid({
                            height: "",
                            autoheight: "true"
                        });
                    }else{
			grid.jqxGrid({
                            height: "${height}",
                            autoheight: ${autoheight}
                        });
                    }
                    <#else>
                        var x = ${beforeprocessing};
                        if(typeof(x) == 'function'){
                            x();
                        }
                    </#if>
                    return res;
                },
                <#if sortable=="true">
                sortcolumn: '${defaultSortColumn}',
                sortdirection: '${sortdirection}',
                </#if>
                <#if pageable=="true">
                pagenum: ${viewIndex},
                pagesize: ${viewSize},
                entityName: '${entityName}',
                </#if>
                <#if (editable=="true" || updaterow=="true" || doubleClick=="true" || updatemultiplerows=="true" || editColumns!="") && (updateRowFunction == "") >
                updateUrl : "${updateUrl}",
                editColumns : "${editColumns}",
                <#elseif updateRowFunction != "" && editable=="true">
                    updaterow: ${updateRowFunction},
                </#if>
                <#if addrow=="true">
                addColumns : "${addColumns}",
                createUrl: "${createUrl}",
                </#if>
                <#if deleterow=="true">              
                removeUrl : "${removeUrl}",
                deleteColumns : "${deleteColumn}", 
                </#if>
                <#if deletesuccessfunction !="" >
        deletesuccessfunction : ${deletesuccessfunction},
                </#if>
                <#if functionAfterUpdate !="" >
        functionAfterUpdate : ${functionAfterUpdate},
                </#if>
        <#if functionAfterAddRow !="" >
        functionAfterAddRow : ${functionAfterAddRow},
                </#if>
	        <#if _customMessErr !="" >
			_customMessErr : ${_customMessErr},
	        </#if>
                root: 'results'
            };           
            /*init jqxgrid */
           var config${id} = {
                source : source${id},
                filterable: ${filterable},
                autoshowfiltericon: true,
			virtualmode: ${virtualmode},
			rtl: ${rightFloat},
                toPrint: ${toPrint},
                excelExport: ${excelExport},
                clearfilteringbutton: ${clearfilteringbutton},
                showdefaultloadelement:${showdefaultloadelement},
                autoshowloadelement:${autoshowloadelement},
                pagesizeoptions: ${pagesizeoptions},
                editable: ${editable},
                <#if autorowheight!="">
                autorowheight: ${autorowheight},
                <#else>
                rowsheight: 25,
                </#if>
                localization: getLocalization(),
                altrows: ${altrows},
                otherParams: "${otherParams}",
                <#if groupable=="true">
                groupable: true,
                showgroupsheader: true,
                </#if>
                <#if groupable == "true" && groups != "">
                    groups:['${groups}'],
                </#if>
                <#if editable=="true">
                    editmode:'${editmode}',
                </#if> 
                selectionmode: '${selectionmode}',    
                ready: function(){   
                    <#if autoload=="false">
                        $("#${id}").jqxGrid("clear");
                    </#if>
                    <#if readyFunction!="">
                        ${readyFunction}
                    </#if>
                },
                width: '${width}',
                <#if showstatusbar=="true">
                    showstatusbar: true,
                    statusbarheight: ${statusbarheight},
                    showaggregates: true,
                <#else>
                    showstatusbar: false,
                    statusbarheight: 0,
                    showaggregates: false,
                </#if>
                <#if height!="" && autoheight == "false">
                    height: "${height}",
                    autoheight : false,
               <#else>
                autoheight:${autoheight},
                </#if>
                <#if columnsheight != "">
                    columnsheight: "${columnsheight}",
               	<#else>
                	columnsheight: 30,
                </#if>
                <#if initrowdetails=="true">
                    rowdetails: true,
                    rowdetailstemplate: { rowdetails: "<div style='margin: 10px;'>${rowdetailstemplateAdvance}</div>", rowdetailsheight: ${rowdetailsheight} },
                    initrowdetails: ${initrowdetailsDetail},
                </#if>
                <#if '${columngrouplist}' != ''>
                    columngroups: [
                         ${columngrouplist} ],
                </#if>
                otherParams : "${otherParams}",
                columnsresize: ${columnsresize},
                columnsreorder: ${columnsreorder},
                sortable: ${sortable},
                scrollmode: '${scrollmode}',
                pageable: ${pageable},
                <#if filterable=="true" && filtersimplemode=="true">
                    showfilterrow: true,
                </#if>
                enablemousewheel: ${enablemousewheel},
                <#if enabletooltips=="true">
                enabletooltips: ${enabletooltips},
                </#if>
                <#if showtoolbar=="true">
                showtoolbar: true,
                rendertoolbar: function (toolbar) {
                    <@renderToolbar id=id isShowTitleProperty=isShowTitleProperty customTitleProperties=customTitleProperties 
                    	isCollapse=isCollapse showlist=showlist customControlAdvance=customControlAdvance filterbutton=filterbutton refreshbutton=refreshbutton
                    	clearfilteringbutton=clearfilteringbutton addrow=addrow addType=addType alternativeAddPopup=alternativeAddPopup 
						virtualmode=virtualmode addinitvalue=addinitvalue primaryColumn=primaryColumn addmultiplerows=addmultiplerows 
						deleterow=deleterow deleteConditionFunction=deleteConditionFunction deleteConditionMessage=deleteConditionMessage 
						updaterow=updaterow updatemultiplerows=updatemultiplerows excelExport=excelExport toPrint=toPrint 
						customcontrol1=customcontrol1 customcontrol2=customcontrol2 customcontrol3=customcontrol3 
						customtoolbaraction=customtoolbaraction/>
                },
                </#if>
                /**add by kieuanhvu**/
                <#if isSaveFormData == "true">
                isSaveFormData: true,
                	<#if formData?has_content>
                	formData: ${formData},
                	</#if>
                </#if>
                /**end**/
           };
           var columns${id} = <#if columnlist?starts_with("[")>${columnlist}<#else>[${columnlist}]</#if>;
            <#if editpopup=="true">
             columns${id}.push({ text: 'Edit', datafield: 'Edit', columntype: 'button', cellsrenderer: function () {
                     return "${StringUtil.wrapString(uiLabelMap.DAEditStatus)}";
                  }, buttonclick: function (row) {
                        Grid.openUpdateSingleRowPopup(grid, "${editColumns}");  
                    }
                });
              </#if>   
        <#if timeout!="" && timeout != "0">
            setTimeout(function(){
            </#if>
            Grid.initGrid(config${id}, ${dataField}, columns${id}, null, grid);
            <#if useCache == "true">
				<#if keyCache != "">
					<#if cacheMode == "" || !cacheMode?exists>
		        		if(bootbox) bootbox.alert("Grid Cache Required @macro property 'cacheMode' example : 'cacheMode= 'all' or 'save','select' ")
		        		else throw new Error("Grid Cache Required @macro property 'cacheMode' example : 'cacheMode= 'save' or 'select' ")
		        	<#else>
						Grid.$initCache('${id}','${keyCache?if_exists}','${keyEdit?if_exists}','${cacheMode?if_exists}');
	        		</#if>
				<#else>
					if(bootbox) bootbox.alert("Grid cache required #macro 'keyCache'!");
					else throw new Error("Grid cache required #macro 'keyCache'!");	
				</#if>
			</#if>
            <#if mouseRightMenu != "false">
                Grid.createContextMenu(grid, $("#${contextMenuId}"), "${allGridMenu}");
            </#if>
            <#if '${groupsexpanded}' == "true">                             
                grid.jqxGrid({ groupsexpandedbydefault: true}); 
            </#if>               
            <#if rowselectfunction != "">
             grid.on('rowselect', function (event) {
                ${rowselectfunction}
             }); 
            </#if>
            <#if url != "">
             grid.on('bindingcomplete', function (event) {
                $("#${id}Container").height('auto');
                $('#${id}').jqxGrid('scrolloffset',0,1);
                CallbackFocusFilter();
             }); 
            <#else>
             $("#${id}Container").height('auto');
            </#if>
            <#if bindingcompletefunction != "">
                grid.on('bindingComplete', function (event) {
                    ${bindingcompletefunction}
                 }); 
            </#if>
            <#if afterinitfunction != "">
                ${afterinitfunction}
            </#if>
            grid.on('cellBeginEdit', function (event) 
             {
                oldEditingValue = $('#${id}').jqxGrid('getrowdata', args.rowindex);
                oldEditingValue = jQuery.extend({}, oldEditingValue);
             });
             grid.on('filter', function(){
                CallbackFocusFilter();
             });
            <#if rowunselectfunction != "">
             grid.on('rowUnselect', function (event) {
                ${rowunselectfunction}
             }); 
            </#if>
            <#if bindresize=="true">
                // Responsive for Grid widget
                setTimeout(function(){
            Grid.bindResize(grid);
        }, 500);

            <#else>
               Grid.initGridNotificationContainer(grid); 
            </#if>
            <#if editpopup=="true" || doubleClick=="true" || updaterow=="true" || addType=="popup">
                Grid.initPopupUpdateSingleRow(grid);
            </#if>
            <#if updatemultiplerows=="true">
                Grid.initPopupUpdateMultiple(grid)                
            </#if> 
            
            <#if doubleClick=="true">
                Grid.bindDoubleClick(grid, "${editColumns}");
            });        
            </#if>            
            <#if autoMeasureHeight=="true" && autoheight='false'>
                (function MesureHeight(){
                    AutoMeasureGridHeight(grid);
                })();
            </#if>
        <#if timeout!="" && timeout != "0">
            }, ${timeout});
        </#if>
        <#if customLoadFunction == "true">
            };
        <#else>
            });
        </#if>         
    </script>
    <#if showlist != "">
        <div id="jqxconfig${id}" style="display:none;">
            <div><i class="fa-cogs btn-mini" style="padding-right:5px;margin:0px;"></i>${uiLabelMap.clconfiguration}</div>
            <div class='form-window-container' id="windowContent${id}">
                <div class='form-window-content'>
                    <div class='row-fluid margin-bottom10'>
                        <div class='span5 text-algin-right'>
                            <label class="asterisk">${uiLabelMap.cldisplay}</label>
                        </div>  
                        <div class="span7">
                            <div id="showSL${id}"></div>
                        </div>      
                    </div>
                    <div class='row-fluid margin-bottom10'>
                        <div class='span5 text-algin-right'>
                            <label class="asterisk">${uiLabelMap.clpin}</label>
                        </div>  
                        <div class="span7">
                            <div id="frozenSL${id}"></div>
                        </div>      
                    </div>
                </div>
                <div class="form-action">
                    <button id="configCancel${id}" class='btn btn-danger form-action-button pull-right'><i class='fa-remove'></i> ${uiLabelMap.CommonCancel}</button>
                    <button id="configSave${id}" class='btn btn-primary form-action-button pull-right'><i class='fa-check'></i> ${uiLabelMap.CommonSave}</button>
                </div>
            </div>
        </div>
    </#if>
    <div id="container${id}" class="container-noti"><#-- style="background-color: transparent; overflow: auto; width: 100%;"-->
    </div>
    <div id="container" class="container-noti"><#-- style="background-color: transparent; overflow: auto;"-->
    </div>
    <div id="jqxNotification${id}">
        <div id="notificationContent${id}">
        </div>
    </div>
    <div id="jqxNotification">
        <div id="notificationContent">
        </div>
    </div>
    <#if idExisted=="false">
        <#if customCss != ""><div class="${customCss}"></#if>
            <div id="${id}Container" style="width: 100%;">
                <div id="${id}">
                </div>
            </div>
        <#if customCss != ""></div></#if>
    </#if>
    <#if editpopup=="true" || doubleClick=="true" || updaterow=="true" || addType=="popup">
    <div id="popupWindow${id}" style="display:none;">
        <div>Edit</div>
        <div style="overflow: hidden;">
            <table>
                 <#list "${editColumns}"?split(";") as eColumn>
                    <tr>
                        <td align="right">${eColumn}:</td>
                        <#if '${eColumn}' == '${primaryColumn}' >
                            <td align="left"><input id="${eColumn}" readonly/></td>
                        <#else>
                            <td align="left"><input id="${eColumn}" /></td>
                        </#if>
                    </tr>
                 </#list>                      
                <tr>
                    <td align="right"></td>
                    <td style="padding-top: 10px;" align="right"><input style="margin-right: 5px;" type="button" id="Save${id}" value="Save" /><input id="Cancel${id}" type="button" value="Cancel" /></td>
                </tr>
            </table>
        </div>
    </div>
    <div id="dialog-confirm-container${id}" title="Modify data?">
        <div style="overflow: hidden;">
            <div style="margin-top: 10px;" id="dialog-confirm${id}"></div>
        </div>
    </div>
    <div id="dialog-message-container${id}" title="Modify data?">      
        <div style="margin-top: 10px;" id="dialog-message${id}"></div>
    </div>
            
    </#if> 
     <#if updatemultiplerows=="true">
        <div id="popupModifyWindow${id}">
            <div>Edit</div>
            <div style="overflow: hidden;">
                <table>
                    <tr>
                        <td align="right">New values:</td>
                        <td align="left"><input id="newValueUpdate${id}" /></td>
                        <tr>
                        <td align="right"></td>
                        <td style="padding-top: 10px;" align="right"><input style="margin-right: 5px;" type="button" id="SaveModify${id}" value="Save" /><input id="CancelModify${id}" type="button" value="Cancel" /></td>
                    </tr>
                    </tr>                    
                </table>
            </div>
        </div>      
     </#if>   
     <div id="dialog-delete${id}" title="${StringUtil.wrapString(uiLabelMap.wgdeletedata)}?">       
    </div>  
</#macro>

<#macro renderJqxTitle titlePropertyTmp id>
    <#if titlePropertyTmp?contains("-")>
        var jqxheader = $("<div id='toolbarcontainer${id}' class='widget-header'><h4>"
            <#list titlePropertyTmp?split("-") as str>
                <#if str?contains("[")>
                <#assign strTmp = str?substring(2, str?length - 1)/>
                    + "${strTmp}" + "&nbsp;"
                <#else>
                    + "${StringUtil.wrapString(uiLabelMap[str])}&nbsp;"
                </#if>
            </#list> 
            + "</h4><div id='toolbarButtonContainer${id}' class='pull-right'></div></div>");
    <#else>
        var jqxheader = $("<div id='toolbarcontainer${id}' class='widget-header'><h4>" + "${StringUtil.wrapString(uiLabelMap[titlePropertyTmp])}" + "</h4><div id='toolbarButtonContainer${id}' class='pull-right'></div></div>");
    </#if>
</#macro>
<#global renderJqxTitle=renderJqxTitle />

<#macro renderToolbar id="jqxgrid" isShowTitleProperty="true" customTitleProperties="" isCollapse="false" showlist="true" 
		customControlAdvance="" filterbutton="" clearfilteringbutton="false" refreshbutton="false" addrow="" addType="direct" alternativeAddPopup=""
		virtualmode="true" addinitvalue="" primaryColumn="ID" addmultiplerows="false" deleterow="" deleteConditionFunction="" 
		deleteConditionMessage="" updaterow="" updatemultiplerows="" excelExport="false" toPrint="false" 
		customcontrol1="" customcontrol2="" customcontrol3="" customtoolbaraction="">
	if(toolbar.html()){
        return;
    }
    var grid = $('#${id}');
    var me = this;
    <#if titleProperty?has_content && isShowTitleProperty=="true" && customTitleProperties == "">
        <@renderJqxTitle titlePropertyTmp=titleProperty id=id/>
    <#elseif isShowTitleProperty=="true" && customTitleProperties != "">
        <@renderJqxTitle titlePropertyTmp=customTitleProperties id=id/>
    <#else>
        var jqxheader = $("<div id='toolbarcontainer${id}' class='widget-header'><h4>" + "</h4><div id='toolbarButtonContainer${id}' class='pull-right'></div></div>");
    </#if>
    toolbar.append(jqxheader);
    <#if isCollapse == "true">
    //Grid.createCollapseButton(grid);
    </#if>
    var container = $('#toolbarButtonContainer${id}');
    var mainContainer = $("#toolbarcontainer${id}");
    <#if showlist != "false">
        Grid.createSettingButton(grid, container, '${showlist}');
    </#if>
    <#if customControlAdvance != "">
        Grid.triggerToolbarEvent(grid, container,"${customControlAdvance}");
    </#if>

    <#if filterbutton=="true">
        Grid.createFilterButton(grid, container, "${uiLabelMap.accFilter}");
    </#if>
    <#if clearfilteringbutton=="true">
        Grid.createFilterButton(grid, container, "${uiLabelMap.accRemoveFilter}");
    </#if>
    <#if refreshbutton=="true">
        Grid.createRefreshButton(grid, container, "${uiLabelMap.RefreshData}");
    </#if>
    <#if addrow=="true">
        Grid.createAddRowButton(
            grid, container, "${uiLabelMap.accAddNewRow}", {
                type: "${addType}",
                container: $("#${alternativeAddPopup}"),
    			<#if virtualmode=="true" && addType!="popup">
                    <#if addinitvalue !="">
                        data : {
                            ${primaryColumn}: '${addinitvalue}' 
                        }
                    <#else>//edit by hoanm
                        data : '${primaryColumn}'
                    </#if>  
                </#if>
            }
        );
    </#if>
    <#if addmultiplerows=="true">
        Grid.createAddMultiRowButton(grid, container, "Add Multiple New Rows");
    </#if>
    <#if deleterow=="true">
        <#if deleteConditionFunction !="">
            var dcf = ${deleteConditionFunction};
        <#else>
            var dcf = "";
        </#if>
        Grid.createDeleteRowButton(grid, container, "${uiLabelMap.wgdelete}", dcf,
                                "${deleteConditionMessage}", "${StringUtil.wrapString(uiLabelMap.CannotDeleteRow)}", 
                                "${StringUtil.wrapString(uiLabelMap.wgdeleteconfirm)}",
                                "${StringUtil.wrapString(uiLabelMap.wgok)}", 
                                "${StringUtil.wrapString(uiLabelMap.wgcancel)}");
    </#if>
    <#if updaterow=="true">
        Grid.addUpdateRowButton(grid, container, "${uiLabelMap.accUpdateSelectedRow}");
    </#if>
    <#if updatemultiplerows=="true">
        Grid.createUpdateMultiRowButton(grid, container, '${uiLabelMap.accUpdateMultipleRow}');
    </#if>      
    <#if excelExport=="true">
    Grid.createExcelExport(grid, container, "${uiLabelMap.accExcel}");
    </#if> 
    <#if toPrint=="true">
    Grid.createPrintButton(grid, container, "${uiLabelMap.accPrint}");
    </#if>
    <#if customcontrol1 != "">
    Grid.createCustomControlButton(grid, container, "${StringUtil.wrapString(customcontrol1)}");
    </#if>
    <#if customcontrol2 != "">
    Grid.createCustomControlButton(grid, container, "${StringUtil.wrapString(customcontrol2)}");
    </#if>
    <#if customcontrol3 != "">
    Grid.createCustomControlButton(grid, container, "${StringUtil.wrapString(customcontrol3)}");
    </#if>
    <#if customtoolbaraction != "">
    Grid.createCustomAction(grid, mainContainer, ${customtoolbaraction});
    </#if>  
    grid.trigger('rendertoolbarcompleted');
</#macro>
<#global renderToolbar=renderToolbar>
<#global jqTreeGridMinimumLib=jqTreeGridMinimumLib>
